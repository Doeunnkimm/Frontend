## 23.3 실행 컨텍스트의 역할

- 다음 에제는 전역 코드와 함수 코드로 구성되어 있다.
- 자바스크립트 엔진이 이 예제를 어떻게 평가하고 실행할지 생각해보자.

```js
// 전역 변수 선언
const x = 1;
const y = 2;

// 함수 정의
function foo(a) {
    // 지역 변수 선언
    const x = 10;
    const y = 20;

    // 메서드 호출
    console.log(a + x + y) // 130
}

// 함수 호출
foo(100)

// 메서드 호출
console.log(x + y) // 3
```

### 1. 전역 코드 평가

- 전역 코드를 실행하기에 앞서 먼저 전역 코드 평가 과정을 거치며
- 전역 코드를 실행하기 위한 준비를 한다.
- **소스코드 평가 과정에서는 선언문만 먼저 실행**한다.
- 전역 변수와 전역 함수가 실행 컨텍스트가 관리하는 전역 스코프에 등록된다.

### 2. 전역 코드 실행

- 전역 코드 평가 과정이 끝나면 런타임이 시작
- 전역 코드가 순차적으로 실행되기 시작한다.
- 이때 전역 변수에 값이 할당되고 함수가 호출된다.
- 함수가 호출되면 순차적으로 실행되던 전역 코드의 실행을 일시 중단하고 코드 실행 순서를 변경하여 함수 내부로 진입한다.

### 3. 함수 코드 평가

- 함수 호출에 의해 코드 실행 순서가 변경되어 함수 내부로 진입하면
- 함수 내부의 문들을 실행하기에 앞서 함수 코드 평가 과정을 거치며 함수 코드를 실행하기 위한 준비를 한다.
- 이때 매개변수와 지역 변수 선언문이 먼저 실행되고
- 그 결과 생성된 매개변수와 지역 변수가 실행 컨텍스트가 관리하는 지역 스코프에 등록된다.
- 또한 함수 내부에서 지역 변수처럼 사용할 수 있는 arguments 객체가 생성되어 지역 스코프에 등록되고 this 바인딩도 결정된다.

### 4. 함수 코드 실행

- 함수 코드 평가 과정이 끝나면 런타임이 시작
- 함수 코드가 순차적으로 실행되기 시작한다.
- 이때 매개변수와 지역 변수에 값이 할당되고 console.log 메서드가 호출된다.
- `console.log` 메서드를 호출하기 위해 먼저 식별자인 console을 스코프 체인을 통해 검색
- 이를 위해 함수 코드의 지역 스코프는 상위 스코프인 전역 스코프와 연결되어야 한다.


```
💡 실행 컨텐스트는 식별자(변수, 함수, 클래스 등의 이름)를 등록하고 관리하는 스코프와
   코드 실행 순서 관리를 구현한 내부 매커니즘으로,
   모든 코드는 실행 컨텍스트를 통해 실행되고 관리된다.
```